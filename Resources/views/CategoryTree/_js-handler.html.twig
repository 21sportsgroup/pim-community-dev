<script type="text/javascript">
    var assetsPath = "{{ asset('bundles/pimproduct/') }}";
    var tree_id = "#tree";
    var urlListTree = "{{ path('pim_product_categorytree_listtree', { '_format': 'json' }) }}";
    var urlChildren = "{{ path('pim_product_categorytree_children', { '_format': 'json' }) }}";
    
    // define buttons actions
    $(".tree-toolbar button").click(function () {
        switch(this.id) {
            case "category-edit":
                var node = $.jstree._focused().get_selected();
                if(!$.jstree._focused()._get_node(node)) {
                    PimDialog.alert("{{ 'You must select a node.' | trans }}", "{{ 'Alert message' | trans }}");
                } else {
                    var categoryId = node.attr("id").replace('node_', '');
                    window.location = "{{ path('pim_product_categorytree_edit') }}/"+categoryId;
                }
                break;
            case "category-remove":
                if(!$.jstree._focused()._get_node($.jstree._focused().get_selected())) {
                    PimDialog.alert("{{ 'You must select a node to remove.' | trans }}", "{{ 'Alert message' | trans }}");
                } else {
                    var doRemove = function() {
                        $(tree_id).jstree("remove");
                    };
                    PimDialog.confirm(
                        "{{ 'Are you sure you want to delete the category' | trans }}",
                        "{{ 'Delete Confirmation' | trans }}",
                        doRemove
                    );
                }
                break;
        }
    });
    
    $(".tree-toolbar a").click(function() {
        switch (this.id) {
            case "tree-create":
                window.location = "{{ path('pim_product_categorytree_create') }}";
                break;
            case "category-create":
                var node = $.jstree._focused().get_selected();
                if(!$.jstree._focused()._get_node()) {
                    PimDialog.alert("{{ 'You must select a parent node.' | trans }}", "{{ 'Alert message' | trans }}");
                } else {
                    var parentId = node.attr("id").replace('node_', '');
                    window.location = "{{ path('pim_product_categorytree_create') }}/"+parentId;
                }
                break;
        }
    });
</script>
<script type="text/javascript" src="{{ asset('bundles/pimproduct/js/tree-management.jstree.js') }}"></script>
<script>
     $(document).ready(function () {
        var column_height = $("#form-tab").height();
        $(".tree-sidebar").css("min-height",column_height);
    });
</script>
